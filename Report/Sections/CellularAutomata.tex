\section{Cellular Automata}
\label{CA}

\subsection{General Overview}
\label{CA_General}

A cellular automata is a form for model that can simulate artificial life and is often used in computational tasks (e.g. procedual contant generation\cite{togelius2011search}), mathematics and biology. 

Cellular automatas are made from a regular grid of cells, where each cell can have one state out of a finite set of states. A cellular automata also contains a set of fixed rules that determines how a cell's state is affected by the cells around it, known as a cell's \textit{neighbourhood}. The rules are applied to all cells in the grid at once\footnote{Not all cells may have a rule that applies, in which case it keeps its state.} in order to create a new generation. New generations are created either until a certain criteria is reached, or until a chosen number of generations have passed.

The number of states in a cellular automata can range from two different states (e.g. \textit{active} and \textit{not-active}) all the up to a practically infinite number. The more states, however, the more complex the cellular automata will be. Every state will need to be linked to at least one rule (otherwise there is no point in having the state) and the more states that exist, the more complex their interactions will become.

Cellular automata rules use \textit{neighbourhoods} to determine what happens to a cell (e.g. if five of the surrounding cells are active, change the state of this cell to active). These neighbourhoods determines which of the surrounding cells whose states are considered with regards to changing the current cell. There are two different neighbourhoods that are used in most cellular automatas; \textit{von Neumann} and \textit{Moore}. \textit{von Neumann} covers the cells horizontally and vertically in either direction from the current cell. \textit{Moore} covers not only horizontally and vertically, but also diagonally. Both neighbourhoods only consider cells one tile away from current cell, but they can be \textit{extended} to cover a larger area. Figure \ref{fig:CA_Neighbourhoods} shows the two neighbourhoods along with their extended versions.

\insertPicture{1}{CA_Neighbourhoods2}{The neighbourhoods used in cellular automatas.}{CA_Neighbourhoods}

\subsection{Our Cellular Automata}
\label{CA_Our}

We use a cellular automata to generate the initial heightmap for the phenotype. In order to save time, the cellular automata only work on the top 60\% of the map, which later is mirrored to form a complete map. We work on 60\% instead of 50\% in order to avoid that the cells at the bottom of the working area are biased by the empty cells below. This still happens with 60\%, but as the map is mirrored, the bottom cells will be overwritten and the bias will have no influence.

\subsubsection{Initial Seeding}

The cellular automata is initialized by randomly seeding the map with one of the different height levels through the use of random number generation. The default odds are the following:

\begin{itemize}

	\item \textbf{Height2}: $odds$ $<$ 0.25

	\item \textbf{Height1}: 0.25 $\le$ $odds$ $<$ 0.50

	\item \textbf{Height0}: 0.50 $\le$ $odds$

\end{itemize}

Before the seeding process begins, \textbf{x} \textit{focus points} are randomly determined. During seeding, for every cell a random number between 0.0 and 1.0 is generated and the state of the cell is set to the corresponding height-level, as shown above. If the cell is within 15 tiles of any of the \textit{focus points}, the generated number is reduced\footnote{This heightens the odds of a higher height-level occouring} depending on how close the cell is to a focus point. The reduction follows the calculation

\begin{equation} \label{eq:oddsReduction}
	odds := \langle odds\rangle - \frac{15 - \langle actualDistance\rangle}{15 \times 3}
\end{equation}

where \textit{odds} is the original chance generated and \textit{actualDistance} is the actual distance to the closest of the focus points. This results in a reduction of up to 0.33. Furthermore, if the cell less than $\frac{15}{2}$ from the closest focus point, the following calculation is applied after calculation \ref{eq:oddsReduction}.

\begin{equation}
	odds := \frac{\langle odds\rangle}{2}
\end{equation}

\subsubsection{Ruleset}

The default rules we use focus on creating connected areas of the same height-level. This is done in order to mimic how StarCraft maps actually look. The default ruleset does leave single tiles of odd heights around, which is later cleaned by smoothing the terrain out using another ruleset. \textbf{Wrap this up somehow.}